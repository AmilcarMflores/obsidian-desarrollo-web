## Navegación básica en el DOM
Podemos navegar por el DOM usando el objeto `document` que contiene todo el HTML y es una representación de la página web. **Navegar sobre estos elementos puede llevarte al elemento que necesitas para manipularlo.**

Vamos a buscar el tesoro en nuestro DOM, comencemos con este fragmento de HTML:
```html
<!DOCTYPE html>
<html>
<body>
<h1>Encontremos el tesoro</h1>
<div id="forest">
  <div id="tree1">
    <div id="squirrel"></div>
    <div id="flower"></div>
  </div>
  <div id="tree2">
    <div id="shrubbery">
      <div id="treasure"></div>
    </div>
    <div id="mushroom">
      <div id="bug"></div>
    </div>
  </div>
</div>
</body>
</html>
```
Ahora queremos navegar por el DOM de este fragmento para encontrar el tesoro. **Podemos hacerlo accediendo al objeto `document` y navegando desde allí en adelante.**

Comenzamos usando la propiedad `body`:
```javascript
console.dir(document.body);
```
Deberíamos obtener un objeto muy largo.

Ahora usaremos las propiedades `children` y `childNodes`:
	- `children`: solo contiene todos los elementos HTML, por lo que son realmente los nodos. Puedes usar el ID.
	- `childNodes`: también contiene nodos de texto y comentarios.

Para llegar al tesoro usando `children` tendrías que usar:
```javascript
console.dir(document.body.children.forest.children.tree2.children.shrubbery.children.treasure);
```
Cada elemento que seleccionamos, tenemos que seleccionar los `children` nuevamente.

Para llegar al tesoro usando `childNodes` tendrías que usar mucho tu consola porque los nodos de texto y comentarios también están allí. `childNodes` es un array, por lo que tendrás que seleccionar el índice correcto para seleccionar el `child` correcto:
```javascript
console.dir(document.body.childNodes[3].childNodes[3].childNodes[1].childNodes[1]);
```
### Manipulación dinámica de elementos usando el DOM
Hasta ahora, hemos visto cómo podemos movernos hacia abajo en el DOM, pero también podemos movernos hacia arriba. Cada elemento conoce a su padre. Podemos usar la propiedad `parentElement` para movernos hacia arriba. 

Por ejemplo, si usamos el ejemplo HTML del tesoro y escribimos esto en la consola:
```javascript
document.body.children.forest.children.tree2.parentElement;
```
Volvemos a `forest`, ya que ese es el elemento padre de `tree2`.

No solo podemos movernos hacia arriba y hacia abajo, también podemos movernos lateralmente. Por ejemplo, si seleccionamos `tree2` así:
```javascript
document.body.children.forest.children.tree2;
```

Podemos llegar a `tree1` usando:
```javascript
document.body.children.forest.children.tree2.previousElementSibling;
```

Y desde `tree1` podemos llegar a `tree2` usando:treasure
```javascript
document.body.children.forest.children.tree1.nextElementSibling;
```
Como alternativa a `nextElementSibling`, que devuelve el siguiente nodo que es un elemento, podrías usar `nextSibling`, que devolverá el siguiente nodo de cualquier tipo.
## Selección de elementos como objetos
En lugar de usar `console.dir()`, podemos simplemente escribir la ruta al elemento que queremos cambiar. Ahora tenemos el elemento como un objeto JavaScript, y podemos hacer cambios a todas sus propiedades.

```html
<!DOCTYPE html>
<html>
<body>
<h1>Página de bienvenida</h1>
<p id="greeting">
    ¡Hola!
</p>
</body>
</html>
```

Podemos navegar hasta el elemento `p`, por ejemplo, usando este código:
```javascript
document.body.children.greeting;
```
¡Esto nos da el poder de manipular las propiedades del elemento, y el elemento mismo, directamente!
### Manipulación dinámica de elementos usando el DOM
#### Cambiando innerText
La propiedad `innerText` se centra en el texto entre la apertura y el cierre del elemento, así:
```html
<elemento>aquí</elemento>
```

El valor recuperado sería "aquí" como texto plano. Por ejemplo, si vamos a la consola y escribimos:
```javascript
document.body.children.greeting.innerText = "¡Adiós!";
```
El mensaje que se muestra en la página cambia de ¡Hola! a ¡Adiós! inmediatamente.
#### Cambiando innerHTML
Esta propiedad no solo procesa texto plano, también puede ser elementos HTML internos:
```javascript
document.body.children.greeting.innerHTML = "<b>¡Adiós!</b>";
```
Esto mostrará **¡Adiós!** en negrita en la pantalla.
## Acceso a elementos en el DOM
Después de obtener los elementos, podemos modificarlos. **En lugar de navegar paso a paso como acabamos de hacer, vamos a usar métodos incorporados que pueden recorrer el DOM y devolver los elementos que coincidan con las especificaciones.**

Ejemplo:
```html
<!DOCTYPE html>
<html>
<body>
    <h1>Solo un ejemplo</h1>
    <div id="one" class="example">¡Hola!</div>
    <div id="two" class="example">¡Hola!</div>
    <div id="three" class="something">¡Hola!</div>
</body>
</html>
```
Comencemos accediendo a elementos por ID.
### Acceso a elementos por ID
Podemos tomar elementos por ID con el método `getElementById()`. Esto devuelve un elemento con el ID especificado.

Si queremos seleccionar el elemento con un ID de `two` inmediatamente, podríamos usar:
```javascript
document.getElementById("two");
```

Esto devolvería el elemento HTML completo:
```html
<div id="two" class="example">¡Hola!</div>
```
### Acceso a elementos por nombre de etiqueta
Si pedimos elementos por nombre de etiqueta, obtenemos un array como resultado. Será una colección de elementos HTML, o `HTMLCollection`, que es un objeto JavaScript especial:
```javascript
document.getElementsByTagName("div");
```

Devolverá:
```text
HTMLCollection(3) [div#one.example, div#two.example, div#three.something, one: div#one.example, two: div#two.example, three: div#three.something]
```
Los primeros en la colección son los objetos: `div` es el nombre, `#` especifica el ID, y `.` especifica la clase. Si hay múltiples puntos, hay múltiples clases. Luego puedes ver los elementos nuevamente (`namedItems`), esta vez como pares clave-valor con su ID como clave.

Podemos acceder a ellos usando el método `item()` para acceder por índice, así:
```javascript
document.getElementsByTagName("div").item(1);
```

Esto devolverá:
```html
<div id="two" class="example">¡Hola!</div>
```

También podemos acceder a ellos por nombre, usando el método `namedItem()`, así:
```javascript
document.getElementsByTagName("div").namedItem("one");
```

Y esto devolverá:
```html
<div id="one" class="example">¡Hola!</div>
```
### Acceso a elementos por nombre de clase
En nuestro HTML de ejemplo, tenemos dos nombres de clase diferentes: `example` y `something`. Si obtienes elementos por nombre de clase, devuelve un `HTMLCollection` que contiene los resultados. 

Lo siguiente obtendrá todos los elementos con la clase `example`:
```javascript
document.getElementsByClassName("example");
```
### Acceso a elementos con un selector CSS
Lo hacemos con `querySelector()` y `querySelectorAll()`. Luego damos el selector CSS como argumento.

Si declaramos `p` como un selector CSS, significa todos los elementos con etiqueta `p`. Esto se vería así:
```javascript
document.querySelectorAll("p");
```
Si decimos `p.example`, significa todos los elementos de etiqueta `p` con `example` como la clase. También pueden tener otras clases; siempre que `example` esté allí, coincidirá. También podemos decir `#one`, lo que significa seleccionar todos con un ID de `one`.
### Usando `querySelector()`
Esta primera opción seleccionará el primer elemento que coincida con la consulta:
```javascript
document.querySelector("div");
```

Debería devolver:
```html
<div id="one" class="example">¡Hola!</div>
```

También podríamos pedir un elemento con la clase `.something`:
```javascript
document.querySelector(".something");
```

### Usando `querySelectorAll()`
Devuelve todos los elementos que coincidan con la consulta.
```javascript
document.querySelectorAll("div");
```
## Manejador de clics en elementos
Los elementos HTML pueden hacer algo cuando se hace clic en ellos. Esto se debe a que una función JavaScript puede conectarse a un elemento HTML:
```html
<!DOCTYPE html>
<html>
<body>
    <div id="one" onclick="alert('¡Ay! ¡Para!')">¡No hagas clic aquí!</div>
</body>
</html>
``` 

o también el script puede estar externo:
```html
<!DOCTYPE html>
<html>
<body>
    <script>
    function stop(){
        alert("¡Ay! ¡Para!");
    }
    </script>
    <div id="one" onclick="stop()">¡No hagas clic aquí!</div>
</body>
</html>
```

También hay una forma de agregar un manejador de clics usando JavaScript:
```html
<!DOCTYPE html>
<html>
<body>
	<div id="one">¡No hagas clic aquí!</div>
</body>
</html>
```

En la consola:
```javascript
document.getElementById("one").onclick = function () {
    alert("¡Ay! ¡Para!");
}
```

## "This" y el DOM
En el DOM, la palabra `this` se refiere al elemento del DOM al que pertenece. 

Si especificamos un `onclick` para enviar `this` como argumento, enviará el elemento en el que está el `onclick`:
```html
<!DOCTYPE html>
<html>
<body>
<script>
    function reveal(el){
        console.log(el);
    }
</script>
    <button onclick="reveal(this)">¡Haz clic aquí!</button>
</body>
</html>
```

Y esto es lo que registrará:
```html
<button onclick="reveal(this)">¡Haz clic aquí!</button>
```
Está registrando el elemento en el que está, el elemento `button`.

Podemos acceder al padre `this` con una función como esta:
```javascript
function reveal(el){
    console.log(el.parentElement);
}
```
En el ejemplo anterior, el `body` es el padre del botón.

Es útil, por ejemplo, cuando necesitas obtener el valor de una caja de entrada. Si envías `this`, entonces puedes leer y modificar las propiedades del elemento que activó la función.
## Manipulación del estilo de elementos
Podemos hacer esto usando la propiedad `style`. Así es cómo se hace:
1. Selecciona el elemento correcto del DOM.
2. Cambia la propiedad correcta de la propiedad `style` de este elemento.

En este fragmento de HTML y JavaScript alternará la visualización de un texto:
```html
<!DOCTYPE html>
<html>
<body>
<script>
    function toggleDisplay(){
        let p = document.getElementById("magic");
        if(p.style.display === "none") {
            p.style.display = "block";
        } else {
            p.style.display = "none";
        }
    }
</script>
<p id="magic">Puedo desaparecer y aparecer.</p>
<button onclick="toggleDisplay()">¡Magia!</button>
</body>
</html>
```
## Cambio de las clases de un elemento
Con JavaScript, podemos cambiar las clases de los elementos HTML, y esto podría activar un diseño certain asociado con esa clase en CSS. Vamos a echar un vistazo a agregar clases, eliminar clases y alternar clases.
### Agregar clases a elementos
```html
<!DOCTYPE html>
<html>
<body>
    <script>
        function disappear(){
            document.getElementById("shape").classList.add("hide");
        }
    </script>
    <style>
        .hide {
            display: none;
        }

        .square {
            height: 100px;
            width: 100px;
            background-color: yellow;
        }

        .square.blue {
            background-color: blue;
        }
    </style>

    <div id="shape" class="square blue"></div>
    <button onclick="disappear()">¡Desaparece!</button>
    
    </body>
</html>
```
En este ejemplo, tenemos algo de CSS especificado en la etiqueta `style` y los elementos con la clase `hide` tienen un estilo `display:none` (desaparece).
### Eliminar clases de elementos
```html
<!DOCTYPE html>
<html>
<body>
<script>
    function change(){
        document.getElementById("shape").classList.remove("blue");
    }
</script>
<style>
    .square {
        height: 100px;
        width: 100px;
        background-color: yellow;
    }
    .square.blue {
        background-color: blue;
    }
</style>
<div id="shape" class="square blue"></div>

    <button onclick="change()">¡Cambia!</button>
    </body>
</html>
```
Cuando se presiona el botón, se activa la función `change`. Esta función elimina la clase `blue`, que elimina el color de fondo azul del diseño dejándonos con el color de fondo amarillo y el cuadrado se volverá amarillo.
### Alternar clases
En algunos casos, querrías agregar una clase cuando no tiene esa clase particular, pero eliminarla cuando la tiene. Esto se llama alternar:
```html
<!DOCTYPE html>
<html>
<body>
    <script>
        function changeVisibility(){
	        document.getElementById("shape").classList.toggle("hide");
        }
    </script>
    <style>
        .hide {
            display: none;
        }

        .square {
            height: 100px;
            width: 100px;
            background-color: yellow;
        }
    </style>
    
    <div id="shape" class="square"></div>
    <button onclick="changeVisibility()">¡Magia!</button>
</body>
</html>
```
Presionar el botón agregará la clase al `classList` cuando no esté allí y la eliminará cuando esté allí.  
### Manipulación de atributos
Con el método `setAttribute()`, podemos agregar o cambiar atributos en un elemento. Esto cambiará el HTML de la página.
```html
<!DOCTYPE html>
<html>
<body>
    <script>
        function changeAttr(){
            let el = document.getElementById("shape");
            el.setAttribute("style", "background-color:red;border:1px solid black");
            el.setAttribute("id", "new");
            el.setAttribute("class", "circle");
        }
    </script>
    <style>
        div {
            height: 100px;
            width: 100px;
            background-color: yellow;
        }

        .circle {
        border-radius: 50%;
        }
    </style>
    
    <div id="shape" class="square"></div>
    <button onclick="changeAttr()">Cambiar atributos...</button>
</body>
</html>
```
Los atributos cambian si presionas el botón, el `id` cambia de `shape` a `new`, la `class` cambia de `square` a `circle` y se agrega un `style`.
## "Event Listeners" en elementos
Los eventos son cosas que suceden en una página web, como hacer clic en algo, mover el mouse sobre un elemento, cambiar un elemento, y hay muchos más. 

Ya sabemos agregar un manejador de eventos `onclick`, de la misma manera, podemos agregar un manejador `onchange`, o un manejador `onmouseover`.

Sin embargo, hay una condición especial; un elemento solo puede tener un manejador de eventos como atributo HTML. Entonces, si tiene un manejador `onclick`, no puedes tener un manejador `onmouseover` también.

Solo vimos cómo agregar "event listeners" usando atributos HTML:
```html
<button onclick="addRandomNumber()">Agregar un número</button>
```

**Hay una forma de registrar manejadores de eventos usando JavaScript también. Los llamamos "event listeners". Usando "event listeners", podemos agregar múltiples eventos a un elemento.**

Agregar "event listeners" es un proceso de dos pasos:
1. Selecciona el elemento al que quieres agregar un evento.
2. Usa la sintaxis `addEventListener("event", función)` para agregar el evento.

Aunque son dos pasos, se puede hacer en una línea de código:
```javascript
document.getElementById("square").addEventListener("click", changeColor);
```
Esto está obteniendo el elemento con el ID `square` y agregando la función `changeColor` como el evento para cuando sea cliqueado.

Cuando usas "event listeners", eliminamos el prefijo `on` del tipo de evento. Por ejemplo, `click` aquí hace referencia al mismo tipo de evento que `onclick`
### Manipulación dinámica de elementos usando el DOM
Podríamos reutilizar nuestro confiable listener `onclick` en este contexto pero otro común es cuando la página web ha terminado de cargarse con `onload`:
```javascript
window.onload = function() {
    // lo que sea que necesite suceder después de cargar
    // por ejemplo, agregar event listeners a elementos
}
```
Esta función se ejecutará entonces.

Veamos un ejemplo del primer "event listener" que vimos en una página web:
```html
<!DOCTYPE html>
<html>
<body>
<script>
    window.onload = function() {
        document.getElementById("square").addEventListener("click", changeColor);
    }
    function changeColor(){
        let red = Math.floor(Math.random() * 256);
        let green = Math.floor(Math.random() * 256);
        let blue = Math.floor(Math.random() * 256);
        this.style.backgroundColor = `rgb(${red}, ${green}, ${blue})`;
    }
</script>
<div id="square" style="width:100px;height:100px;background-color:grey;">Haz clic para magia</div>
</body>
</html>
```
La página web comienza con un cuadrado gris con el texto "Haz clic para magia" en él. Después de que la página web termina de cargarse, se agrega un evento para este cuadrado. Siempre que se haga clic en él, se ejecutará la función `changeColor`. Esta función usa variables aleatorias para cambiar el color usando colores RGB. Siempre que hagas clic en el cuadrado, el color se actualiza con valores aleatorios.
## Creación de nuevos elementos
Consiste en dos pasos, primero crear nuevos elementos y segundo agregarlos al DOM:
```javascript
let el = document.createElement("p");
el.innerText = Math.floor(Math.random() * 100);
document.body.appendChild(el);
``` 
Crea un elemento de tipo `p`. Esta es una función `createElement()` que está en el objeto `document`. 

---
# Progreso
- Necesitamos repasar este capítulo.